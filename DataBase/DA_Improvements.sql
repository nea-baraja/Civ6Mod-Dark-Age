/*
DELETE FROM Improvement_ValidTerrains 
WHERE ImprovementType IN 
('IMPROVEMENT_FARM', 'IMPROVEMENT_MINE');

DELETE FROM Improvement_ValidFeatures 
WHERE ImprovementType IN 
('IMPROVEMENT_FARM');
*/
--改营地和种植园的前置科技
update Improvements set PrereqTech = null 
	where ImprovementType = 'IMPROVEMENT_CAMP';

update Improvements set PrereqTech = 'TECH_POTTERY' 
	where ImprovementType = 'IMPROVEMENT_PLANTATION';


--仅改良资源的设施+1住房
UPDATE Improvements SET Housing = 2 
WHERE ImprovementType IN 
('IMPROVEMENT_PASTURE','IMPROVEMENT_PLANTATION','IMPROVEMENT_FISHING_BOATS');
--种植园和营地 初始产出改为1粮
UPDATE Improvement_YieldChanges SET YieldChange = 0 
WHERE (ImprovementType = 'IMPROVEMENT_PLANTATION' OR ImprovementType = 'IMPROVEMENT_CAMP') AND YieldType = 'YIELD_GOLD';

insert or replace into Improvement_YieldChanges(ImprovementType,	YieldType,	YieldChange) values
	('IMPROVEMENT_PLANTATION',	'YIELD_FOOD',	1),
	('IMPROVEMENT_CAMP',		'YIELD_FOOD',	1);

--改良产出随科技增长
delete from Improvement_BonusYieldChanges where ImprovementType in (
	--'IMPROVEMENT_FARM',
	--'IMPROVEMENT_PLANTATION',
	--'IMPROVEMENT_CAMP',
	'IMPROVEMENT_PASTURE'
	--'IMPROVEMENT_QUARRY',
	--'IMPROVEMENT_MINE',
	--'IMPROVEMENT_LUMBER_MILL',
	--'IMPROVEMENT_FISHING_BOATS'
	);

insert or replace into Improvement_BonusYieldChanges
	(Id,	ImprovementType,						YieldType,				BonusYieldChange,	PrereqCivic,					PrereqTech)
values
	(600,	'IMPROVEMENT_PASTURE',					'YIELD_PRODUCTION',			1,					null,						'TECH_HORSEBACK_RIDING');
--改农场和矿山的无资源建造到指定科技
update Improvement_ValidTerrains set PrereqTech = 'TECH_IRRIGATION' 
	where ImprovementType = 'IMPROVEMENT_FARM' and TerrainType in ('TERRAIN_PLAINS', 'TERRAIN_GRASS');

update Improvement_ValidFeatures set PrereqTech = 'TECH_IRRIGATION' 
	where ImprovementType = 'IMPROVEMENT_FARM' and FeatureType = 'FEATURE_FLOODPLAINS';

delete from Improvement_ValidTerrains 
	where ImprovementType = 'IMPROVEMENT_MINE' and TerrainType not in ('TERRAIN_GRASS_HILLS', 'TERRAIN_PLAINS_HILLS'); 

update Improvement_ValidTerrains set PrereqTech = 'TECH_MASONRY' 
	where ImprovementType = 'IMPROVEMENT_MINE' and TerrainType in ('TERRAIN_GRASS_HILLS', 'TERRAIN_PLAINS_HILLS');

--营地建在无资源上
insert or replace into Improvement_ValidFeatures	
	(ImprovementType,				FeatureType,					PrereqTech,			PrereqCivic)
values
	('IMPROVEMENT_CAMP',		'FEATURE_FOREST',		'TECH_ARCHERY',		null),
	('IMPROVEMENT_CAMP',		'FEATURE_JUNGLE',		'TECH_ARCHERY',		null),
	('IMPROVEMENT_CAMP',		'FEATURE_MARSH',		'TECH_ARCHERY',		null);





INSERT OR REPLACE INTO DistrictModifiers (DistrictType, ModifierId) VALUES 
--('DISTRICT_CITY_CENTER', 'DA_FARM_ADJACENT_FOOD'),
--('DISTRICT_CITY_CENTER', 'DA_MINE_ADJACENT_PRODUCTION'),
('DISTRICT_CITY_CENTER', 'DA_FISHING_BOATS_ADJACENT_FOOD'),
('DISTRICT_CITY_CENTER', 'DA_LUMBER_MILL_ADJACENT_PRODUCTION');

INSERT INTO ImprovementModifiers (ImprovementType, ModifierId) VALUES 
('IMPROVEMENT_FARM', 			'DA_FARM_ADJACENT_FOOD'),
('IMPROVEMENT_MINE',			'DA_MINE_ADJACENT_PRODUCTION'),
('IMPROVEMENT_CAMP',			'DA_CAMP_ADJACENT_GOLD'),

--('IMPROVEMENT_PLANTATION', 		'PLANTATION_HOUSE_FROM_GRANARY'),
--('IMPROVEMENT_CAMP', 			'CAMP_HOUSE_FROM_GRANARY'),
--('IMPROVEMENT_PASTURE', 		'PASTURE_HOUSE_FROM_GRANARY');
('IMPROVEMENT_FISHING_BOATS', 		'FISHING_BOATS_HOUSE_FROM_LIGHTHOUSE');



INSERT OR REPLACE INTO Modifiers (ModifierId, ModifierType, RunOnce, Permanent, NewOnly, OwnerRequirementSetId, SubjectRequirementSetId,	SubjectStackLimit) VALUES 
('DA_FARM_ADJACENT_FOOD', 		'MODIFIER_CITY_PLOT_YIELDS_ADJUST_PLOT_YIELD', 0, 0, 0, 'RS_FARM_WITH_RESOURCE', 'RS_FARM_ADJACENT_TO_OWNER', 1),
('DA_MINE_ADJACENT_PRODUCTION', 'MODIFIER_CITY_PLOT_YIELDS_ADJUST_PLOT_YIELD', 0, 0, 0, 'RS_MINE_WITH_RESOURCE', 'RS_MINE_ADJACENT_TO_OWNER', 1),
('DA_CAMP_ADJACENT_GOLD', 		'MODIFIER_CITY_PLOT_YIELDS_ADJUST_PLOT_YIELD', 0, 0, 0, 'RS_CAMP_WITH_RESOURCE', 'RS_CAMP_ADJACENT_TO_OWNER', 1);

INSERT OR REPLACE INTO Modifiers (ModifierId, ModifierType, RunOnce, Permanent, NewOnly, OwnerRequirementSetId, SubjectRequirementSetId) VALUES 
('DA_FISHING_BOATS_ADJACENT_FOOD', 	'MODIFIER_CITY_PLOT_YIELDS_ADJUST_PLOT_YIELD', 0, 0, 0, NULL, 'RS_COAST_ADJACENT_TO_FISHING_BOATS'),
('DA_LUMBER_MILL_ADJACENT_PRODUCTION', 'MODIFIER_CITY_PLOT_YIELDS_ADJUST_PLOT_YIELD', 0, 0, 0, NULL, 'RS_FOREST_ADJACENT_TO_LUMBER_MILL'),
('FARM_HOUSE_FROM_GRANARY', 	'MODIFIER_SINGLE_CITY_ADJUST_IMPROVEMENT_HOUSING', 0, 0, 0, NULL, 'RS_CITY_HAS_GRANARY'),
('PLANTATION_HOUSE_FROM_GRANARY','MODIFIER_SINGLE_CITY_ADJUST_IMPROVEMENT_HOUSING', 0, 0, 0, NULL, 'RS_CITY_HAS_GRANARY'),
('CAMP_HOUSE_FROM_GRANARY', 	'MODIFIER_SINGLE_CITY_ADJUST_IMPROVEMENT_HOUSING', 0, 0, 0, NULL, 'RS_CITY_HAS_GRANARY'),
('PASTURE_HOUSE_FROM_GRANARY', 	'MODIFIER_SINGLE_CITY_ADJUST_IMPROVEMENT_HOUSING', 0, 0, 0, NULL, 'RS_CITY_HAS_GRANARY'),
('FISHING_BOATS_HOUSE_FROM_LIGHTHOUSE', 'MODIFIER_SINGLE_CITY_ADJUST_IMPROVEMENT_HOUSING', 0, 0, 0, NULL, 'RS_CITY_HAS_LIGHTHOUSE');



INSERT OR REPLACE INTO ModifierArguments (ModifierId, Name, Value) VALUES 
('DA_FARM_ADJACENT_FOOD', 		'Amount', '1'), 
('DA_FARM_ADJACENT_FOOD', 		'YieldType', 'YIELD_FOOD'),
('DA_MINE_ADJACENT_PRODUCTION', 'Amount', '1'), 
('DA_MINE_ADJACENT_PRODUCTION', 'YieldType', 'YIELD_PRODUCTION'),
('DA_CAMP_ADJACENT_GOLD', 		'Amount', '3'), 
('DA_CAMP_ADJACENT_GOLD', 		'YieldType', 'YIELD_GOLD'),
('DA_FISHING_BOATS_ADJACENT_FOOD', 		'Amount', '1'), 
('DA_FISHING_BOATS_ADJACENT_FOOD', 		'YieldType', 'YIELD_FOOD'),
('DA_LUMBER_MILL_ADJACENT_PRODUCTION', 'Amount', '1'), 
('DA_LUMBER_MILL_ADJACENT_PRODUCTION', 'YieldType', 'YIELD_PRODUCTION'),
('FARM_HOUSE_FROM_GRANARY', 	'Amount', 	'1'),
('PLANTATION_HOUSE_FROM_GRANARY', 'Amount', '1'),
('CAMP_HOUSE_FROM_GRANARY', 	'Amount', 	'1'),
('PASTURE_HOUSE_FROM_GRANARY', 	'Amount', 	'1'),
('FISHING_BOATS_HOUSE_FROM_LIGHTHOUSE', 'Amount', 	'2');


-- RequirementSets

INSERT OR REPLACE INTO RequirementSets (RequirementSetId, RequirementSetType) VALUES 
('RS_FARM_WITH_RESOURCE',		'REQUIREMENTSET_TEST_ALL'),
('RS_MINE_WITH_RESOURCE',		'REQUIREMENTSET_TEST_ALL'),
('RS_CAMP_WITH_RESOURCE',		'REQUIREMENTSET_TEST_ALL'),

('RS_FARM_ADJACENT_TO_OWNER',	'REQUIREMENTSET_TEST_ALL'),
('RS_MINE_ADJACENT_TO_OWNER',	'REQUIREMENTSET_TEST_ALL'),
('RS_CAMP_ADJACENT_TO_OWNER',	'REQUIREMENTSET_TEST_ALL'),

('RS_PLAIN_ADJACENT_TO_FARM', 	'REQUIREMENTSET_TEST_ALL'),
('RS_HILL_ADJACENT_TO_MINE',  	'REQUIREMENTSET_TEST_ALL'),
('RS_CITY_HAS_GRANARY', 		'REQUIREMENTSET_TEST_ALL'),
('RS_CITY_HAS_LIGHTHOUSE', 		'REQUIREMENTSET_TEST_ALL'),
('RS_COAST_ADJACENT_TO_FISHING_BOATS', 	'REQUIREMENTSET_TEST_ALL'),
('RS_FOREST_ADJACENT_TO_LUMBER_MILL',  	'REQUIREMENTSET_TEST_ALL');

INSERT OR REPLACE INTO RequirementSetRequirements (RequirementSetId, RequirementId) VALUES 
('RS_FARM_WITH_RESOURCE', 		'REQ_PLOT_HAS_IMPROVEMENT_FARM'), 
('RS_FARM_WITH_RESOURCE', 		'REQ_PLOT_HAS_RESOURCE'), 
('RS_MINE_WITH_RESOURCE', 		'REQ_PLOT_HAS_IMPROVEMENT_MINE'), 
('RS_MINE_WITH_RESOURCE', 		'REQ_PLOT_HAS_RESOURCE'),
('RS_CAMP_WITH_RESOURCE', 		'REQ_PLOT_HAS_IMPROVEMENT_CAMP'), 
('RS_CAMP_WITH_RESOURCE', 		'REQ_PLOT_HAS_RESOURCE'), 
('RS_FARM_ADJACENT_TO_OWNER', 	'REQ_PLOT_HAS_IMPROVEMENT_FARM'), 
('RS_FARM_ADJACENT_TO_OWNER', 	'REQ_OBJECT_AWAY_1_TILES'), 
('RS_MINE_ADJACENT_TO_OWNER', 	'REQ_PLOT_HAS_IMPROVEMENT_MINE'), 
('RS_MINE_ADJACENT_TO_OWNER', 	'REQ_OBJECT_AWAY_1_TILES'), 
('RS_CAMP_ADJACENT_TO_OWNER', 	'REQ_PLOT_HAS_IMPROVEMENT_CAMP'), 
('RS_CAMP_ADJACENT_TO_OWNER', 	'REQ_OBJECT_AWAY_1_TILES'), 

('RS_PLAIN_ADJACENT_TO_FARM', 	'REQ_ADJACENT_TO_FARM'), 
('RS_PLAIN_ADJACENT_TO_FARM', 	'REQ_IS_FOOD_PLAIN'),
('RS_HILL_ADJACENT_TO_MINE', 	'REQ_ADJACENT_TO_MINE'), 
('RS_HILL_ADJACENT_TO_MINE', 	'REQ_IS_MINE_HILL'),
('RS_CITY_HAS_GRANARY', 		'REQ_CITY_HAS_GRANARY'),
('RS_CITY_HAS_LIGHTHOUSE', 		'REQ_CITY_HAS_LIGHTHOUSE'),
('RS_COAST_ADJACENT_TO_FISHING_BOATS', 	'REQ_ADJACENT_TO_FISHING_BOATS'), 
('RS_COAST_ADJACENT_TO_FISHING_BOATS', 	'REQ_IS_TERRAIN_COAST'),
('RS_FOREST_ADJACENT_TO_LUMBER_MILL', 	'REQ_ADJACENT_TO_LUMBER_MILL'), 
('RS_FOREST_ADJACENT_TO_LUMBER_MILL', 	'REQ_IS_FEATURE_FOREST');

-- Requirements

INSERT OR REPLACE INTO Requirements (RequirementId, RequirementType) VALUES 
('REQ_ADJACENT_TO_FARM', 	'REQUIREMENT_PLOT_ADJACENT_IMPROVEMENT_TYPE_MATCHES'), 
('REQ_IS_FOOD_PLAIN', 		'REQUIREMENT_PLOT_TERRAIN_CLASS_MATCHES'),
('REQ_ADJACENT_TO_MINE', 	'REQUIREMENT_PLOT_ADJACENT_IMPROVEMENT_TYPE_MATCHES'), 
('REQ_IS_MINE_HILL', 		'REQUIREMENT_PLOT_TERRAIN_CLASS_MATCHES'),
('REQ_CITY_HAS_GRANARY', 	'REQUIREMENT_CITY_HAS_BUILDING'),
('REQ_ADJACENT_TO_FISHING_BOATS', 	'REQUIREMENT_PLOT_ADJACENT_IMPROVEMENT_TYPE_MATCHES'), 
('REQ_ADJACENT_TO_LUMBER_MILL', 	'REQUIREMENT_PLOT_ADJACENT_IMPROVEMENT_TYPE_MATCHES'), 
('REQ_CITY_HAS_LIGHTHOUSE', 'REQUIREMENT_CITY_HAS_BUILDING');

INSERT OR REPLACE INTO RequirementArguments (RequirementId, Name, Value) VALUES 
('REQ_ADJACENT_TO_FARM', 	'ImprovementType', 	'IMPROVEMENT_FARM'), 
('REQ_IS_FOOD_PLAIN', 		'TerrainClass', 	'TERRAIN_CLASS_FOOD_PLAINS'),
('REQ_ADJACENT_TO_MINE', 	'ImprovementType', 	'IMPROVEMENT_MINE'), 
('REQ_IS_MINE_HILL', 		'TerrainClass', 	'TERRAIN_CLASS_MINE_HILLS'),
('REQ_CITY_HAS_GRANARY', 	'BuildingType', 	'BUILDING_GRANARY'),
('REQ_ADJACENT_TO_FISHING_BOATS', 	'ImprovementType', 	'IMPROVEMENT_FISHING_BOATS'), 
('REQ_ADJACENT_TO_LUMBER_MILL', 	'ImprovementType', 	'IMPROVEMENT_LUMBER_MILL'), 
('REQ_CITY_HAS_LIGHTHOUSE', 'BuildingType', 	'BUILDING_LIGHTHOUSE');
